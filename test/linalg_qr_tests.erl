-module(linalg_qr_tests). 
-import(linalg,[qr/1]).
-include_lib("eunit/include/eunit.hrl").

qr_1_test() ->
	?assertEqual({[[1]],[[-49.0]]},qr([[-49.0]])).

qr_2_test() ->
	?assertEqual({[[-0.28000000000000025,0.96],[0.96,0.28]],[[175.0,-70.0],[7.105427357601002e-15,-35.0]]},qr([[-49,-14],[168,-77]])).

qr_3_test() ->
	?assertEqual({[[0.8944271909999157,0.44721359549995804],[0.44721359549995804,-0.8944271909999155]],[[2.2360679774997894,4.919349550499537],[5.551115123125783e-16,-0.8944271909999142]]},qr([[2,4],[1,3]])).

qr_mn_test() ->

	?assertEqual({[[0.2672612419124243,0.9434563530497265], [0.8017837257372732,-0.10482848367219183], [0.5345224838248488,-0.3144854510165756]], [[3.7416573867739413,2.6726124191242437], [0.0,1.362770287738494]]} ,qr([[1,2],[3,2],[2,1]])).

qr_nm_test() ->
	?assertEqual({[[0.3162277660168379,0.9486832980505138], [0.9486832980505138,-0.3162277660168378]], [[3.162277660168379,2.529822128134703, 1.8973665961010275], [4.4408920941132e-16,1.264911064067352, 2.529822128134703]]} ,qr([[1,2,3],[3,2,1]])).
